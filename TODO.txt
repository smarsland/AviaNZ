
# TODO for AviaNZ

SM:

Try to replicate bug in loading /Users/srmarsla/Tier 1/CC18_BIRP_150111_024258.wav
Bug in WaveletSegment training? What has changed?

SM Choose best sets of nodes and evaluate
SM Make the general segmentation more sensitive
SM Get to grips with the bloody wavelet segmenter

NP Features
NP Good training set
NP Work out how not to mistake kiwi
NP Sort out 1 version of code for excel exporting with 1 minute presence/absence
    Move from AviaNZ to SupportClasses
    Add the 1 min workflow (see below)
NP Check manual

BOTH: Decide that v1.0 is ready -- check stability, tidy the segmenters and denoisers options

We should start to decide what makes a specialised filter
    Mingap, minlength
    Threshold for segmenters
    Wavelet nodes
    Trained classifiers

(1) SRM Update the manual lots
(2) SRM And the video!
(3) All Check it's really stable
(4) What else are we adding? Or removing?
    DOC version
(5) SRM Add wavelet segmentation to best
(6) SRM Multiprocessing where possible
    It made things slower!
(7) NP Classify segments
    (i) Wavelets better version
    (ii) Learning based on whatever (check Raven features)
    (iii) SRM Wavelet energy features
(8) NP Parameter setting

Exporter for mac but scipy.misc for Windows - it works fine, but doesn't show the segments on Windows


# What we want from the Tier 1 output:
Presence or absence at some time resolution (e.g., 1 min, or 5 mins)
    (1) Pick up a 1 min section
    (2) Detect kiwi
    (3) As soon as a definite kiwi is detected, mark presence, move on to next section
    (4) If a possible kiwi is detected, mark it and keep on going
    (5) If you find a definite, delete possible, go to (1)
    (6) If find no kiwi mark as absence
    (7) If find only possibles, ask user at end of all file processing using Check segments interface

Work out how to make old wavelet method produce too many segments

Make a new method (not inside Segmentation):
    (1) Perform segmentation using at least one of old wavelet method and any other segmenter, possibly multiple options
    # Partly done, (FIR + median clip). Add in wavelets.
    # And it does need parameters
    (2) Combine the segments as appropriate
    # Two versions are done. Opens it out so far, no max. Either with or without envelopes kept.
    (3) Perform classification on each segment using at least one of wavelet energies, Raven features, MFCC, LPC, fundamental freq
    # To be done (ready to modify wavelet segmentation part)

Plot the wavelet energy for noise, crickets, calls, etc.
    Suppress the noise nodes, reconstruct -- what happens?
Parallel process the segmenters

get name from standard files and use it
    # Name bit is done, not yet used

# Look into the invertible CQT
    # Doesn't seem to help with tril1
# Dominant frequency
# warbleR features
# plots of eg xcorr
# DTW - 2D, fast
    look into DP

NP:

*** Ensure saving of the config file and the data files on Windows
# done

Test the idea of using the wavelet nodes with either
    (a or b or c) and not (d or e)
    (a and (b or c))
    or maybe both :)
    Will have to count the number of times each occurs
    Idea is to reduce (i) misclassifications, (2) crickets, (3) wide-band clicks, (4) rain

Make a pretty (simple) version of the Process File dialog
#Done, but seems like I have to add more features to this interface
    (1) add a help (manual)
    (2) Check if the folder has been processed halfway in a previous go find the new starting point rather than starting from first file
    (3) Train wavelet to detect wind and rain so that the user can run this detector to see the proportion of useful data
        (e.g. SIPO dataset is rainy, so almost all the recordings turned out to be positive due to rain)

Enable parameter setting
#done

Raven features

Denoising experiments
    -> short time better than long?
    -> denoise only segments
    -> compare python and matlab

Segmentation experiments
    -> like thesis but better :)
    -> paper

(1) Minor bugs and extensions

    NP: Read mp3 files
# SM: pysox

    NP: Make it possible to change parameters (look into pyqtgraph ParameterTree)
    done

    ??: What to do with stereo sound? How about consistent sample rates?

    NP: Make play sounds play the denoised version after denoising
# This seems to be complicated with undo etc. Still thinking whats the best way to do it,
  can easily add a separate button to play denoised but not nice. I fixed the plotting problem though.

	NP: Stop loading the file when choose to cancel the progress bar
# Removed the cancel button for now. otherwise have to unroll what happened inside the loadFile when the user cancel it.

	File list dock becomes frozen - one was experiencing this. Had to restart the program.
	    # Can we reproduce it?

    NP: Fully integrate wavelet seg into program
    NP: We actually want Kiwi (M) and Kiwi (F), and need to get all the ruru calls
    NP: Want to have some form of machine learning
		(1) decision tree
		(2) MLP
		(3) SVM
		(4) boosting
    SM: And need to think about the 95% confidence thing a lot more

    SM: Make the segmentations work fully
        Get the minimum time of a segment parameter sorted
        Work out how to combine the methods, particularly, spot overlaps in segments and combine them
        Work out parameters and how to set them
        Remove cross-correlation? Or just improve?

    Both: Think about nice ways to train a new wavelet filter
		And get the whole workflow sorted for it

(4) Features
    Use the wavelets
    Finish the Raven features
    Add MFCC (nearly done)
    And whatever else seems interesting

    More on fundamental frequency
        smoothing?
        harvest or bana (yaapt was awful)
    Shape metrics

(5) Learning
    Standard methods
        MLP
        Decision tree
        Boosting
        SVM
    LSTM or GRU

    HMM to string syllables together

(6) Other
    Think more about the spectrogram inversion
        If it works --> Stu's bats
        Denoise the spectrogram fully (median filter, smoothing, consider grab-cut)

    Any necessary database or metadata things?

    Bats do keep on coming up...

    Generative noise model

# If we do decide to move to qt5
selecting things from QListWidget seems to have changed
setTextColor -> setForeground
there is no phonon -> QMultimedia
    seek -> setPosition
    didn't look into this further
there is no QString -> Python strings now work

# Tier 1
(1) Segmentation that is as good as we can get it
(2) Wavelet recognition ditto
(3) Non-wavelet recognition ditto